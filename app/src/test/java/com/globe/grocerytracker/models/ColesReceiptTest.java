package com.globe.grocerytracker.models;

import org.junit.Test;

import java.util.List;

import static org.junit.Assert.*;

public class ColesReceiptTest {

    @Test
    public void parse1() {
        String parsedText = "4/5/2020 Gmail - Your collection 60654440 has been confirmed\nSteven Crossin <cro0016@gmail.com>\nYour collection 60654440 has been confirmed\n2 messages\nno-reply@coles.com.au <no-reply@coles.com.au> 16 March 2020 at 03:55\nTo: cro0016@gmail.com\nONLINE ORDER RECEIVED\nHi Steven\nRemember, you can modify this order\nThanks for shopping at Coles.\nuntil 12:00PM Monday 16 March 2020.\nWe’ve received your order\n(#60654440). For any questions,\nplease contact our customer care team\nvia text on 0429 989 656. We are always\nhappy to help.\nCOLLECTION DETAILS\nColes Collingwood, 132-172 Smith Street\nStore:\nCOLLINGWOOD\nTime: 6:00PM – 8:00PM on Monday 16 March 2020\n \nPlease enter the ?Main Coles Carpark? via little oxford ST,\nInstructions:\ntake an immediate right turn and make your way to the click and\ncollect parking bays. Please press intercom to let us know that\nyou have arrived. Tell us the name the order was placed in and\nwe will bring your groceries out to you. You will need to sign for\nyour order. Lastly, if you are picking up tobacco or liquor please\nensure you have suitable ID.Please remember to bring your\nbags as this store is moving towards bagless collection\nClick here to get directions.\nORDER SUMMARY\nQuantity Price\nEaster (1)\nColes\n$1.08\n2\nBrown Onions\n$3.00 per 1 Kg\nQuantity Price\nEntertaining at Home (4)\nColes\n$11.20\n1\nBeef Porterhouse Steak\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 1/3\n4/5/2020 Gmail - Your collection 60654440 has been confirmed\n$28.00 per 1 Kg\nColes\n$1.50\n1\nGarlic loose\n$25.00 per 1 Kg\nColes\n$12.35\nRSPCA Approved Chicken Breast\n1\n$9.50 per 1 Kg\nFillets Large Pack\nColes\n$6.64\nRSPCA Approved Chicken\n1\n$4.50 per 1 Kg\nDrumsticks\nQuantity Price\nHealth & Beauty (1)\nKleenex\n$3.00\n1\nFacial Tissues Eucalyptus\n$2.14 per 100 Ea\nQuantity Price\nHousehold (2)\nMultix\n$2.40\n1\nMedium Freezer Bags\n$0.03 per 1 Ea\nAjax\n$3.00\nSpray N Wipe Kitchen Stone Safe\n1\n$0.60 per 100 mL\nCleaner Trigger Pack\nQuantity Price\nMeat, Seafood & Deli (1)\nColes\n$6.00\n1\n3 Star Regular Beef Mince\n$1.20 per 100 G\nQuantity Price\nPantry (5)\nBarilla\n$2.40\n1\nAngel Hair Pasta\n$0.53 per 100 G\nLeggo's\n$2.00\nBolognese with Chunky Tomato\n1\n$0.40 per 100 G\nGarlic & Herbs Pasta Sauce\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 2/3\n4/5/2020 Gmail - Your collection 60654440 has been confirmed\nCadbury\n$2.00\n2\nCherry Ripe Chocolate Bar\n$1.92 per 100 G\nSunrice\n$20.00\n1\nJasmine Fragrant Rice\n$0.40 per 100 G\nColes\n$2.50\n2\nMinced Garlic\n$0.05 per 10 G\nEstimated total* $76.07\nYou've saved: $3.40\n* This is our best estimate of what your order will cost. We’ll let you know the final price once we’ve completed your\nshopping. Find out more about potential price variations.\nThis email has been sent to cro0016@gmail.com because it was used to place an order at coles online.\n______________________________________________________________________\nThis email and any attachments may contain privileged and confidential\ninformation and are intended for the named addressee only. If you have\nreceived this e-mail in error, please notify the sender and delete\nthis e-mail immediately. Any confidentiality, privilege or copyright\nis not waived or lost because this e-mail has been sent to you in\nerror. It is your responsibility to check this e-mail and any\nattachments for viruses. No warranty is made that this material is\nfree from computer virus or any other defect or error. Any\nloss/damage incurred by using this material is not the sender's\nresponsibility. The sender's entire liability will be limited to\nresupplying the material.\n______________________________________________________________________\nno-reply@coles.com.au <no-reply@coles.com.au> 16 March 2020 at 08:00\nTo: cro0016@gmail.com\n[Quoted text hidden]\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 3/3\n";
        ColesReceipt colesReceipt = new ColesReceipt(parsedText);
        List<ReceiptLineItem> receiptLineItems = colesReceipt.Parse();
        float total = 0;
        for (ReceiptLineItem item : receiptLineItems)
            total += item.price;

        assertTrue(receiptLineItems.size() == 14);
        assertEquals(76.07, total, 0.01);
    }

    @Test
    public void parse2() {
        // has item with 3 lines description
        String parsedText = "4/5/2020 Gmail - Your collection 60654440 has been confirmed\nSteven Crossin <cro0016@gmail.com>\nYour collection 60654440 has been confirmed\n2 messages\nno-reply@coles.com.au <no-reply@coles.com.au> 16 March 2020 at 03:55\nTo: cro0016@gmail.com\nONLINE ORDER RECEIVED\nHi Steven\nRemember, you can modify this order\nThanks for shopping at Coles.\nuntil 12:00PM Monday 16 March 2020.\nWe’ve received your order\n(#60654440). For any questions,\nplease contact our customer care team\nvia text on 0429 989 656. We are always\nhappy to help.\nCOLLECTION DETAILS\nColes Collingwood, 132-172 Smith Street\nStore:\nCOLLINGWOOD\nTime: 6:00PM – 8:00PM on Monday 16 March 2020\n \nPlease enter the ?Main Coles Carpark? via little oxford ST,\nInstructions:\ntake an immediate right turn and make your way to the click and\ncollect parking bays. Please press intercom to let us know that\nyou have arrived. Tell us the name the order was placed in and\nwe will bring your groceries out to you. You will need to sign for\nyour order. Lastly, if you are picking up tobacco or liquor please\nensure you have suitable ID.Please remember to bring your\nbags as this store is moving towards bagless collection\nClick here to get directions.\nORDER SUMMARY\nQuantity Price\nEaster (1)\nColes\n$1.08\n2\nBrown Onions\n$3.00 per 1 Kg\nQuantity Price\nEntertaining at Home (4)\nColes\n$11.20\n1\nBeef Porterhouse Steak\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 1/3\n4/5/2020 Gmail - Your collection 60654440 has been confirmed\n$28.00 per 1 Kg\nColes\n$1.50\n1\nGarlic loose\n$25.00 per 1 Kg\nColes\n$12.35\nRSPCA Approved Chicken Breast\n1\n$9.50 per 1 Kg\nFillets Large Pack\nColes\n$6.64\nRSPCA Approved Chicken\n1\n$4.50 per 1 Kg\nDrumsticks\nDrumsticks1\nQuantity Price\nHealth & Beauty (1)\nKleenex\n$3.00\n1\nFacial Tissues Eucalyptus\n$2.14 per 100 Ea\nQuantity Price\nHousehold (2)\nMultix\n$2.40\n1\nMedium Freezer Bags\n$0.03 per 1 Ea\nAjax\n$3.00\nSpray N Wipe Kitchen Stone Safe\n1\n$0.60 per 100 mL\nCleaner Trigger Pack\nQuantity Price\nMeat, Seafood & Deli (1)\nColes\n$6.00\n1\n3 Star Regular Beef Mince\n$1.20 per 100 G\nQuantity Price\nPantry (5)\nBarilla\n$2.40\n1\nAngel Hair Pasta\n$0.53 per 100 G\nLeggo's\n$2.00\nBolognese with Chunky Tomato\n1\n$0.40 per 100 G\nGarlic & Herbs Pasta Sauce\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 2/3\n4/5/2020 Gmail - Your collection 60654440 has been confirmed\nCadbury\n$2.00\n2\nCherry Ripe Chocolate Bar\n$1.92 per 100 G\nSunrice\n$20.00\n1\nJasmine Fragrant Rice\n$0.40 per 100 G\nColes\n$2.50\n2\nMinced Garlic\n$0.05 per 10 G\nEstimated total* $76.07\nYou've saved: $3.40\n* This is our best estimate of what your order will cost. We’ll let you know the final price once we’ve completed your\nshopping. Find out more about potential price variations.\nThis email has been sent to cro0016@gmail.com because it was used to place an order at coles online.\n______________________________________________________________________\nThis email and any attachments may contain privileged and confidential\ninformation and are intended for the named addressee only. If you have\nreceived this e-mail in error, please notify the sender and delete\nthis e-mail immediately. Any confidentiality, privilege or copyright\nis not waived or lost because this e-mail has been sent to you in\nerror. It is your responsibility to check this e-mail and any\nattachments for viruses. No warranty is made that this material is\nfree from computer virus or any other defect or error. Any\nloss/damage incurred by using this material is not the sender's\nresponsibility. The sender's entire liability will be limited to\nresupplying the material.\n______________________________________________________________________\nno-reply@coles.com.au <no-reply@coles.com.au> 16 March 2020 at 08:00\nTo: cro0016@gmail.com\n[Quoted text hidden]\n…\nhttps://mail.google.com/mail/u/1?ik=9496520748&view=pt&search=all&permthid=thread-f%3A1661249847421564124&simpl=msg-f%3A1661249 3/3\n";
        ColesReceipt colesReceipt = new ColesReceipt(parsedText);
        List<ReceiptLineItem> receiptLineItems = colesReceipt.Parse();
        float total = 0;
        for (ReceiptLineItem item : receiptLineItems)
            total += item.price;

        assertTrue(receiptLineItems.size() == 14);
        assertEquals(76.07, total, 0.01);
    }
}